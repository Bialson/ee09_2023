## Egzamin zawodowy EE.09 2023

### 1. Informacje wstpne
Aby przystpi do rozwizywania egzaminu, nale偶y wpierw zapozna si z informacjami podanymi w arkuszu egzaminacyjnym. 

Najpierw, nale偶y zalogowa si na konto `Egzamin` bez hasa. Na pulpicie znajduje si archiwum
ZIP o nazwie zad1.zip zabezpieczone hasem: `AKt@PR@cownicZE`
Archiwum nale偶y rozpakowa.

Na pulpicie konta `Egzamin` nale偶y utworzy folder. Jako nazwy folderu nale偶y u偶y numeru zdajcego,
kt贸rym zosta podpisany arkusz. Rozpakowane pliki nale偶y umieci w tym folderze. Zaleca si, aby
rozpakowane pliki znajdoway si w tym samym folderze, co pliki strony. Po skoczonej pracy wszystkie
wyniki nale偶y zapisa w tym folderze.

Po wykonaniu tych krok贸w mo偶emy przej do pierwszej czci, czyli opracji na bazie danych

### 2. Operacje na bazie danych
Aby wykona zadanie nale偶y przeczyta zamieszczon instrukcj (zakadam, 偶e jest zrozumiaa i nie trzeba jej przypomiana ).

Zanim przystpimy do tworzenia zapyta, dobrze jest zrozumie ich tre i okreli przewidywany rezultat. Przeanalizujmy zatem ka偶de zapytanie.
#### Zapytanie 1
Nale偶y posu偶y si skadni polecenia `SELECT`:
~~~sql
SELECT [pola] FROM [tabela] WHERE [warunki] [inne polecenia]
~~~
Uwzgldniajc powy偶sz formu otrzymamy kocow odpowied藕.
~~~sql
SELECT imie, nazwisko, adres, miasto, czyRODO, czyBadania FROM pracownicy WHERE id=2
~~~
#### Zapytanie 2
Tutaj, tak偶e stosujemy skadni `SELECT` oraz korzystamy z funkcji agregujcej [`COUNT()`](https://www.w3schools.com/sql/func_mysql_count.asp) 
~~~sql
SELECT COUNT(*) FROM pracownicy
~~~
#### Zapytanie 3
~~~sql
SELECT id, imie, nazwisko FROM pracownicy WHERE id=2
~~~
#### Zapytanie 4
Aby wykona to zapytanie nale偶y posu偶y si relacj wedug poni偶szego szablonu:
~~~sql
SELECT pole1.tabela1, pole2.tabela2 FROM tabela1 JOIN tabela2 ON tabela1.klucz=tabela2.klucz ...[reszta polece]
~~~
W rezultacie otrzymamy:
~~~sql
SELECT stanowiska.nazwa, stanowiska.opis FROM stanowiska JOIN pracownicy ON stanowiska.id = pracownicy.stanowiska_id WHERE pracownicy.id=2
~~~

### 3. Witryna internetowa
Aby utworzy stron egzaminacyjn korzystamy z informacji zawartych w arkuszu, dotyczcych struktury strony, stylu itd, struktury folder贸w itd.

`Nale偶y r贸wnie偶 wspomnie o przeskalowaniu zawartej w archiwum grafiki z zachowaniem proporcji do szerokoci 400px.`

Poni偶ej zamieszczam kod strony oraz plik CSS
##### index.php
~~~php
<?php 
    $connection = mysqli_connect('localhost', 'root', '', 'firma');
?>
<!DOCTYPE html>
<html lang="pl-PL">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="styl.css">
    <title>Sekretariat</title>
</head>
<body>
    <section id="left">
        <h1>Akta Pracownicze</h1>
        <?php 
            $query = "SELECT imie, nazwisko, adres, miasto, czyRODO, czyBadania FROM pracownicy WHERE id=2";
            $result = mysqli_query($connection, $query);
            $workerData = mysqli_fetch_array($result);
            $rodoStatus = ($workerData[4] == 1) ? "podpisano" : "niepodpisano";
            $examineStatus = ($workerData[5] == 1) ? "aktualne" : "nieaktualne";
            echo("
                <h3>dane</h3>
                <p>$workerData[0] $workerData[1]</p>
                <hr>
                <h3>adres</h3>
                <p>$workerData[2]</p>
                <p>$workerData[3]</p>
                <hr>
                <p>RODO: $rodoStatus</p>
                <p>Badania: $examineStatus</p>
            ");
        ?>
        <hr>
        <h3>Dokumenty pracownika</h3>
        <a href="cv.txt">Pobierz</a>
        <h1>Liczba zatrudnionych pracownik贸w</h1>
        <p>
            <?php
                $query = "SELECT COUNT(*) FROM pracownicy";
                $result = mysqli_query($connection, $query);
                echo(mysqli_fetch_array($result)[0]);
            ?>
        </p>
    </section>
    <section id="right">
        <?php
            $query = "SELECT id, imie, nazwisko FROM pracownicy WHERE id=2";
            $result = mysqli_query($connection, $query);
            $workerData = mysqli_fetch_array($result);
            $fileName = $workerData[0].".jpg";
            echo("
                <img src='".$fileName."' alt='pracownik'>
                <h2>$workerData[1] $workerData[2]</h2>
            ");

            $query = "SELECT stanowiska.nazwa, stanowiska.opis FROM stanowiska JOIN pracownicy ON stanowiska.id = pracownicy.stanowiska_id WHERE pracownicy.id=2";
            $result = mysqli_query($connection, $query);
            $workerData = mysqli_fetch_array($result);
            echo("
                <h4>$workerData[0]</h4>
                <h5>$workerData[1]</h5>
            ");
        ?>
    </section>
    <footer>
        Autorem aplikacji jest: 00000000000
        <ul>
            <li>skontaktuj si</li>
            <li>poznaj nasz firm</li>
        </ul>
    </footer>
</body>
</html>
<?php mysqli_close($connection); ?>
~~~

##### styl.css
~~~css
body, html {
    font-family: Helvetica;
    background-color: #DDD;
    color: #546E7A;
}

section {
    background-color: #FFF;
    height: 600px;
    margin: 20px;
    box-shadow: 0 0 20px gray;
}

#left {
    width: 50%;
    float: left;
}

#right {
    width: 30%;
    float: right;
}

footer {
    background-color: #5C6BC0;
    color: #FFF;
    padding: 30px;
    clear: both;
}

h1{
    background-color: #5C6BC0;
    color: #FFF;
    padding: 10px;
    margin: 0;
    font-weight: 300;
}

img{
    width: 100%;
}

h3, p {
    padding-left: 30px;
}

h2, h4 {
    text-align: center;
}
~~~

### 2.1 Skrypty PHP
Do ka偶dego skryptu potrzebujemy poczenia z baz danych wic na pocztku moduu deklarujemy poczenie.
~~~php
$connection = mysqli_connect('localhost', 'root', '', 'firma'); //mysqli_connect - funkcja tworzca poczenie z baz danych
~~~

Mo偶na r贸wnie偶 wspomnie o u偶ytych funkcjach do obsugi MySQL. Podane s one r贸wnie偶 w arkuszu. 

| Funckja | Zwracana warto |
| - | :- |
| mysqli_connect(serwer, u偶ytkownik, haso, nazwa_bazy) | id poczenia lub FALSE, gdy niepowodzenie |
| mysqli_select_db(id_polaczenia, nazwa_bazy) | TRUE/FALSE w zale偶noci od stanu operacji |
| mysqli_error(id_polaczenia)  | Tekst komunikatu bdu |
| mysqli_close(id_polaczenia) | TRUE/FALSE w zale偶noci od stanu operacji |
| mysqli_query(id_polaczenia, zapytanie) | Wynik zapytania |
| mysqli_fetch_row(wynik_zapytania) | Tablica numeryczna odpowiadajca wierszowi zapytania |
| mysqli_fetch_array(wynik_zapytania)  | Tablica zawierajca kolejny wiersz z podanych w wyniku zapytania lub FALSE, je偶eli nie ma wicej wierszy w wyniku zapytania |
| mysqli_num_rows(wynik_zapytania)  | Liczba wierszy w podanym zapytaniu |
| mysqli_num_fields(wynik_zapytania)  | Liczba kolumn w podanym zapytaniu |

#### Skrypt 1
Skrypt ma za zadanie wysa zapytanie 1 do bazy i zwr贸ci wskazane dane. Korzystjc z funkcji do operacji na bazie danych tworzymy skrypt, kt贸ry realizuje podane zao偶enia
~~~php
<?php 
	$query = "SELECT imie, nazwisko, adres, miasto, czyRODO, czyBadania FROM pracownicy WHERE id=2";
	$result = mysqli_query($connection, $query);
	$workerData = mysqli_fetch_array($result);
	$rodoStatus = ($workerData[4] == 1) ? "podpisano" : "niepodpisano";
	$examineStatus = ($workerData[5] == 1) ? "aktualne" : "nieaktualne";
	echo("
		<h3>dane</h3>
		<p>$workerData[0] $workerData[1]</p>
		<hr>
		<h3>adres</h3>
		<p>$workerData[2]</p>
		<p>$workerData[3]</p>
		<hr>
		<p>RODO: $rodoStatus</p>
		<p>Badania: $examineStatus</p>
	");
?>
~~~
Powy偶szy skrypt, wycigane dane pracownika z bazy o ID r贸wnym 2 i tworzy kart z jego danymi. 

#### Skrypt 2
Skrypt ma za zadanie wysa zapytanie 2 do bazy i zwr贸ci liczb zwr贸con zapytaniem. 
~~~php
<?php
	$query = "SELECT COUNT(*) FROM pracownicy";
	$result = mysqli_query($connection, $query);
	echo(mysqli_fetch_array($result)[0]);
?>
~~~
Powy偶szy skrypt, zwr贸ci liczb pracownik贸w z tabeli pracownicy.

#### Skrypt 3
Skrypt ma za zadanie wysa zapytanie 3 i 4 do bazy i zwr贸ci wskazane dane.
~~~php
<?php
	$query = "SELECT id, imie, nazwisko FROM pracownicy WHERE id=2";
	$result = mysqli_query($connection, $query);
	$workerData = mysqli_fetch_array($result);
	$fileName = $workerData[0].".jpg";
	echo("
		<img src='".$fileName."' alt='pracownik'>
		<h2>$workerData[1] $workerData[2]</h2>
	");

	$query = "SELECT stanowiska.nazwa, stanowiska.opis FROM stanowiska JOIN pracownicy ON stanowiska.id = pracownicy.stanowiska_id WHERE pracownicy.id=2";
	$result = mysqli_query($connection, $query);
	$workerData = mysqli_fetch_array($result);
	echo("
		<h4>$workerData[0]</h4>
		<h5>$workerData[1]</h5>
	");
?>
~~~
Powy偶szy skrypt, wywietli obrazek pracownika o ID r贸wnym 2, imi i nazwisko, stanowisko oraz jego opis.